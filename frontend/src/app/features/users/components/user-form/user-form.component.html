<!-- English: User form with sections for profile, access, and notes. -->
<!-- Italiano: form utente con sezioni per anagrafica, accesso e note. -->
<!-- English: Sections include two-column grid and CTA footer. -->
<!-- Italiano: Sezioni: griglia a due colonne e footer con CTA. -->
<!-- English: UI/UX choice: separate sections to reduce input errors. -->
<!-- Italiano: Scelte UI/UX: sezioni separate per ridurre errori di compilazione. -->
<form class="user-form" #userForm="ngForm" (ngSubmit)="onSubmit(userForm)">
  <!-- English: Profile section. -->
  <!-- Italiano: Sezione anagrafica. -->
  <div class="form-section">
    <h4>Profile details</h4>
    <div class="form-grid">
      <ui-input
        label="Email"
        name="email"
        type="email"
        placeholder="name@company.com"
        [(ngModel)]="formData.email"
        [readonly]="readOnly"
        [required]="true"
        [error]="submitted && !formData.email ? 'Email is required' : ''"
      ></ui-input>
      <ui-input
        label="Company"
        name="company"
        placeholder="Email domain"
        [(ngModel)]="formData.company"
        [readonly]="true"
        helper="Derived from the email domain"
      ></ui-input>
    </div>
  </div>

  <!-- English: Role and access section. -->
  <!-- Italiano: Sezione ruolo e accesso. -->
  <div class="form-section">
    <h4>Role and access</h4>
    <div class="form-grid">
      <ui-select
        label="Role"
        name="role"
        placeholder="Select role"
        [options]="resolvedRoleOptions"
        [(ngModel)]="formData.role"
        [required]="true"
        [disabled]="readOnly"
        [error]="submitted && !formData.role ? 'Role is required' : ''"
      ></ui-select>
      <div class="toggle-field">
        <label class="toggle-label">Status</label>
        <ui-toggle
          [checked]="formData.enabled"
          [disabled]="readOnly"
          ariaLabel="Toggle user status"
          (changed)="onToggle($event)"
        ></ui-toggle>
        <span class="toggle-helper">{{ formData.enabled ? 'Active' : 'Disabled' }}</span>
      </div>
    </div>
  </div>

  <!-- English: Internal notes section. -->
  <!-- Italiano: Sezione note interne. -->
  <div class="form-section">
    <h4>Internal notes</h4>
    <ui-input
      label="Notes"
      name="note"
      placeholder="Add helpful context for the team"
      [multiline]="true"
      [rows]="4"
      [(ngModel)]="formData.note"
      [readonly]="readOnly"
    ></ui-input>
  </div>

  <!-- English: CTA only when not read-only. -->
  <!-- Italiano: CTA solo se non in sola lettura. -->
  <div class="form-actions" *ngIf="!readOnly">
    <ui-button type="submit" [disabled]="userForm.invalid">Save</ui-button>
  </div>
</form>
